# ğŸ“– LecciÃ³n 01: Vulnerability Lifecycle

> **DuraciÃ³n**: 25 minutos
>
> **Objetivo**: Comprender el ciclo completo de gestiÃ³n de vulnerabilidades.

---

## ğŸ¯ Objetivos de Aprendizaje

Al finalizar esta lecciÃ³n serÃ¡s capaz de:

- âœ… Identificar las **4 fases** del ciclo de vida de vulnerabilidades
- âœ… Establecer **SLAs** apropiados segÃºn severidad
- âœ… Implementar un proceso de **triage** efectivo
- âœ… Coordinar **disclosure responsable**

---

## ğŸ“Š Diagrama del Ciclo

![Vulnerability Lifecycle](../0-assets/01-vulnerability-lifecycle.svg)

---

## ğŸ”„ Las 4 Fases del Vulnerability Lifecycle

### 1ï¸âƒ£ Discovery (Descubrimiento)

La vulnerabilidad puede ser descubierta de mÃºltiples formas:

| Fuente | DescripciÃ³n | Ejemplo |
|--------|-------------|---------|
| **Code Scanning** | AnÃ¡lisis estÃ¡tico automatizado | CodeQL detecta SQL Injection |
| **Dependabot** | Alerta de dependencia vulnerable | CVE en lodash 4.17.20 |
| **Security Report** | Reporte externo de investigador | Reporte via SECURITY.md |
| **Pentesting** | Pruebas de penetraciÃ³n | Bug bounty program |
| **Incidente** | Descubierta durante explotaciÃ³n | Log analysis revela intrusiÃ³n |

#### Canales de RecepciÃ³n

```markdown
# Reporte via GitHub
Security â†’ Report a vulnerability

# Reporte via Email
security@tudominio.com

# Bug Bounty
HackerOne, Bugcrowd, etc.
```

---

### 2ï¸âƒ£ Triage (ClasificaciÃ³n)

El triage determina la **validez** y **prioridad** de la vulnerabilidad.

#### Checklist de Triage

```markdown
â–¡ Â¿Es vÃ¡lida la vulnerabilidad?
â–¡ Â¿Se puede reproducir?
â–¡ Â¿CuÃ¡l es el impacto real?
â–¡ Â¿QuÃ© versiones estÃ¡n afectadas?
â–¡ Â¿Existe explotaciÃ³n activa?
â–¡ Â¿Hay workaround disponible?
```

#### Criterios de PriorizaciÃ³n

| Factor | Peso | DescripciÃ³n |
|--------|------|-------------|
| Severidad CVSS | Alto | Score base de la vulnerabilidad |
| Explotabilidad | Alto | Â¿Existe exploit pÃºblico? |
| ExposiciÃ³n | Medio | Â¿CuÃ¡ntos usuarios afectados? |
| Complejidad del fix | Bajo | Â¿CuÃ¡nto tiempo tomarÃ¡? |

#### Matriz de PriorizaciÃ³n

```
                    EXPLOTABILIDAD
                    Baja    Alta
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    Alta      â”‚   P2    â”‚   P1    â”‚
SEVERIDAD     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    Baja      â”‚   P4    â”‚   P3    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

P1 = Fix inmediato (24-48h)
P2 = Fix urgente (1 semana)
P3 = Fix planificado (2-4 semanas)
P4 = Backlog (siguiente release)
```

---

### 3ï¸âƒ£ Remediation (RemediaciÃ³n)

Desarrollo del fix siguiendo mejores prÃ¡cticas de seguridad.

#### Workflow de RemediaciÃ³n

```
1. Crear Security Advisory (draft)
   â†“
2. Fork privado temporal (desde el advisory)
   â†“
3. Desarrollar fix en el fork privado
   â†“
4. Code review con equipo de seguridad
   â†“
5. Testing exhaustivo
   â†“
6. Preparar release notes
```

#### Mejores PrÃ¡cticas

```markdown
âœ… DO:
- Desarrollar en fork privado
- Incluir tests de regresiÃ³n
- Documentar el cambio
- Minimizar breaking changes
- Review por segundo par de ojos

âŒ DON'T:
- Publicar detalles antes del fix
- Push directo a main
- Skip testing "porque es urgente"
- Commits con mensaje "security fix"
```

#### Ejemplo: Private Fork

```bash
# El fork privado se crea desde el Security Advisory
# GitHub lo genera automÃ¡ticamente

# En el fork privado:
git checkout -b fix/sql-injection-cve-2024-xxxxx
# ... hacer cambios ...
git commit -m "fix: sanitize user input in search query"
git push origin fix/sql-injection-cve-2024-xxxxx
```

---

### 4ï¸âƒ£ Disclosure (DivulgaciÃ³n)

PublicaciÃ³n coordinada de la vulnerabilidad y el fix.

#### Timeline de Disclosure

```
DÃ­a 0: Reporte recibido
       â†“ Acknowledge (48h max)
DÃ­a 2: Triage completado
       â†“ Comunicar al reporter
DÃ­a 5: Fix en desarrollo
       â†“
DÃ­a 30-90: Fix listo
       â†“ Coordinar fecha de release
DÃ­a X: Disclosure coordinado
       - Merge fix a main
       - Publicar advisory
       - CVE asignado
       - Notificar usuarios
```

#### Tipos de Disclosure

| Tipo | DescripciÃ³n | CuÃ¡ndo usar |
|------|-------------|-------------|
| **Coordinated** | Con acuerdo del reporter | Caso ideal |
| **Full** | Todo pÃºblico desde el inicio | No recomendado |
| **Partial** | Detalles limitados hasta fix | Mientras se desarrolla |
| **0-day** | Sin previo aviso (explotaciÃ³n activa) | Emergencias |

#### ComunicaciÃ³n de Disclosure

```markdown
# Contenido del Advisory PÃºblico

## Summary
Breve descripciÃ³n de la vulnerabilidad.

## Affected Versions
- 1.0.0 - 1.2.3 (affected)
- 1.2.4+ (patched)

## Severity
High (CVSS 7.5)

## Impact
DescripciÃ³n del impacto potencial.

## Mitigation
1. Actualizar a versiÃ³n 1.2.4
2. Workaround si no es posible actualizar

## Credit
Gracias a [Reporter Name] por el reporte responsable.

## Timeline
- 2024-01-15: Reporte recibido
- 2024-01-17: Vulnerabilidad confirmada
- 2024-02-15: Fix desarrollado
- 2024-02-20: Release y disclosure
```

---

## â±ï¸ SLAs por Severidad

| Severidad | CVSS | Acknowledge | Triage | Fix Target |
|-----------|------|-------------|--------|------------|
| ğŸ”´ Critical | 9.0-10.0 | 4h | 24h | 24-48h |
| ğŸŸ  High | 7.0-8.9 | 24h | 48h | 7 dÃ­as |
| ğŸŸ¡ Medium | 4.0-6.9 | 48h | 5 dÃ­as | 30 dÃ­as |
| ğŸŸ¢ Low | 0.1-3.9 | 72h | 7 dÃ­as | 90 dÃ­as |

---

## ğŸ”§ Herramientas de GestiÃ³n

### GitHub Native

```
Security tab â†’ Advisories     # GestiÃ³n de advisories
Security tab â†’ Overview       # Dashboard de seguridad
Dependabot alerts            # Vulnerabilidades en deps
Code scanning alerts         # Vulnerabilidades en cÃ³digo
```

### Externas

| Herramienta | Uso |
|-------------|-----|
| Jira/Linear | Tracking de issues de seguridad |
| PagerDuty | Alertas crÃ­ticas 24/7 |
| Slack/Teams | ComunicaciÃ³n del equipo |
| CVE.org | Buscar CVEs relacionados |

---

## ğŸ“ Ejercicio PrÃ¡ctico

### Escenario

Recibes el siguiente reporte:

```
Subject: SQL Injection in /api/search endpoint

Hi,

I found a SQL injection vulnerability in your search API.

Steps to reproduce:
1. Go to /api/search
2. Enter: ' OR '1'='1
3. All user data is returned

Impact: Full database access

Let me know if you need more details.

Best,
Security Researcher
```

### Preguntas

1. Â¿CuÃ¡l es la severidad estimada (CVSS)?
2. Â¿QuÃ© prioridad asignarÃ­as (P1-P4)?
3. Â¿CuÃ¡les son los primeros 3 pasos a tomar?
4. Â¿CuÃ¡l serÃ­a el timeline de respuesta?

---

## ğŸ¯ Resumen

| Fase | AcciÃ³n Clave | Output |
|------|--------------|--------|
| Discovery | Identificar y documentar | Reporte inicial |
| Triage | Validar y priorizar | Severidad + Prioridad |
| Remediation | Desarrollar fix | CÃ³digo + Tests |
| Disclosure | Publicar y notificar | Advisory + CVE |

---

## ğŸ“š Recursos Adicionales

- [GitHub Security Advisories](https://docs.github.com/en/code-security/security-advisories)
- [FIRST CVSS Calculator](https://www.first.org/cvss/calculator/3.1)
- [NIST Vulnerability Management](https://nvd.nist.gov/)
- [ISO 27001 - Incident Management](https://www.iso.org/isoiec-27001-information-security.html)

---

## âœ… Checklist de ComprensiÃ³n

- [ ] Puedo identificar las 4 fases del lifecycle
- [ ] SÃ© cÃ³mo priorizar vulnerabilidades
- [ ] Conozco los SLAs por severidad
- [ ] Entiendo el proceso de disclosure coordinado

---

[â¬…ï¸ Volver a Week 12](../README.md) | [Siguiente: Security Advisories â¡ï¸](02-security-advisories.md)
