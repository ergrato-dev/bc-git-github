# ğŸ“– LecciÃ³n 03: CVE Process

> **DuraciÃ³n**: 20 minutos
>
> **Objetivo**: Entender el sistema CVE y cÃ³mo solicitar identificadores a travÃ©s de GitHub.

---

## ğŸ¯ Objetivos de Aprendizaje

Al finalizar esta lecciÃ³n serÃ¡s capaz de:

- âœ… Entender quÃ© es **CVE** y **CNA**
- âœ… Calcular scores **CVSS** correctamente
- âœ… Solicitar **CVE IDs** a travÃ©s de GitHub
- âœ… Diferenciar **CVE, GHSA, CWE**

---

## ğŸ“Š Diagrama del Proceso

![CVE Process](../0-assets/03-cve-process.svg)

---

## ğŸ” Â¿QuÃ© es CVE?

**CVE (Common Vulnerabilities and Exposures)** es un sistema de identificaciÃ³n estÃ¡ndar para vulnerabilidades de seguridad.

### AnatomÃ­a de un CVE ID

```
CVE-2024-12345
â”‚   â”‚    â”‚
â”‚   â”‚    â””â”€â”€ NÃºmero secuencial
â”‚   â””â”€â”€â”€â”€â”€â”€â”€ AÃ±o de asignaciÃ³n
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Prefijo "CVE"
```

### PropÃ³sito del CVE

| Beneficio | DescripciÃ³n |
|-----------|-------------|
| **IdentificaciÃ³n Ãºnica** | Un ID global para cada vulnerabilidad |
| **ComunicaciÃ³n** | Referencia comÃºn entre equipos |
| **Tracking** | Seguimiento de remediaciÃ³n |
| **Compliance** | AuditorÃ­as y reportes de seguridad |

---

## ğŸ¢ GitHub como CNA

### Â¿QuÃ© es un CNA?

**CNA (CVE Numbering Authority)** es una organizaciÃ³n autorizada para asignar CVE IDs.

```
MITRE (Root CNA)
    â”‚
    â”œâ”€â”€ GitHub (CNA)
    â”‚       â””â”€â”€ Asigna CVEs para repos de GitHub
    â”‚
    â”œâ”€â”€ Google (CNA)
    â”œâ”€â”€ Microsoft (CNA)
    â”œâ”€â”€ Red Hat (CNA)
    â””â”€â”€ ... otros CNAs
```

### Scope de GitHub como CNA

```markdown
GitHub puede asignar CVEs para:
âœ… CÃ³digo hosteado en GitHub (pÃºblico o privado)
âœ… Cualquier lenguaje/ecosistema
âœ… A travÃ©s de Security Advisories

GitHub NO asigna CVEs para:
âŒ Software no hosteado en GitHub
âŒ Vulnerabilidades en GitHub mismo (usa HackerOne)
```

---

## ğŸ“ Solicitar un CVE

### Desde un Security Advisory

```
1. Crear draft security advisory
2. En el campo "CVE ID":
   - Click "Request CVE ID"
   - O seleccionar "I will get a CVE ID later"
3. GitHub revisa y asigna automÃ¡ticamente
```

### InformaciÃ³n Requerida

```yaml
# GitHub necesita esta informaciÃ³n para asignar CVE:

Required:
  - Description: DescripciÃ³n de la vulnerabilidad
  - Affected product: Nombre del package/repo
  - Affected versions: Versiones vulnerables
  - Vulnerability type: CWE classification

Recommended:
  - CVSS score: Severidad calculada
  - Patched versions: Versiones con fix
  - References: PRs, commits, documentaciÃ³n
```

### Timeline de AsignaciÃ³n

```
Request submitted
    â†“ (minutos a horas)
GitHub reviews
    â†“ (automÃ¡tico si info completa)
CVE ID assigned (CVE-YYYY-NNNNN)
    â†“
CVE published when advisory goes public
```

---

## ğŸ“Š CVSS Scoring

### CVSS v3.1 Base Metrics

**CVSS (Common Vulnerability Scoring System)** cuantifica la severidad de 0.0 a 10.0.

#### Exploitability Metrics

| MÃ©trica | Valores | DescripciÃ³n |
|---------|---------|-------------|
| **Attack Vector (AV)** | N/A/L/P | Desde dÃ³nde se puede explotar |
| **Attack Complexity (AC)** | L/H | Condiciones necesarias |
| **Privileges Required (PR)** | N/L/H | Nivel de acceso necesario |
| **User Interaction (UI)** | N/R | Â¿Requiere acciÃ³n del usuario? |

#### Impact Metrics

| MÃ©trica | Valores | DescripciÃ³n |
|---------|---------|-------------|
| **Confidentiality (C)** | N/L/H | Impacto en confidencialidad |
| **Integrity (I)** | N/L/H | Impacto en integridad |
| **Availability (A)** | N/L/H | Impacto en disponibilidad |

#### Scope

| MÃ©trica | Valores | DescripciÃ³n |
|---------|---------|-------------|
| **Scope (S)** | U/C | Â¿Afecta otros componentes? |

### Ejemplo de CÃ¡lculo

```yaml
# SQL Injection que permite leer toda la base de datos

Attack Vector: Network (N) = 0.85
# Explotable remotamente via internet

Attack Complexity: Low (L) = 0.77
# No requiere condiciones especiales

Privileges Required: None (N) = 0.85
# No requiere autenticaciÃ³n

User Interaction: None (N) = 0.85
# No requiere acciÃ³n del usuario

Scope: Unchanged (U)
# Solo afecta el componente vulnerable

Confidentiality: High (H) = 0.56
# Acceso total a datos

Integrity: None (N) = 0.00
# No puede modificar datos

Availability: None (N) = 0.00
# No afecta disponibilidad
```

### Vector String

```
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

Score: 7.5 (High)
```

### Calculadora CVSS

```
https://www.first.org/cvss/calculator/3.1

# O usar la calculadora integrada en GitHub:
Security Advisory â†’ Severity â†’ "Calculate CVSS"
```

---

## ğŸ”¤ Diferencias: CVE vs GHSA vs CWE

| Sistema | PropÃ³sito | Ejemplo |
|---------|-----------|---------|
| **CVE** | ID Ãºnico de vulnerabilidad especÃ­fica | CVE-2024-12345 |
| **GHSA** | ID de GitHub Advisory | GHSA-xxxx-xxxx-xxxx |
| **CWE** | CategorÃ­a/tipo de debilidad | CWE-89 (SQL Injection) |

### RelaciÃ³n entre ellos

```
CWE-89 (SQL Injection)
    â”‚
    â”œâ”€â”€ CVE-2024-11111 (en package A)
    â”‚       â””â”€â”€ GHSA-aaaa-bbbb-cccc
    â”‚
    â”œâ”€â”€ CVE-2024-22222 (en package B)
    â”‚       â””â”€â”€ GHSA-dddd-eeee-ffff
    â”‚
    â””â”€â”€ CVE-2024-33333 (en package C)
            â””â”€â”€ GHSA-gggg-hhhh-iiii

Un CWE â†’ Muchos CVEs â†’ Cada CVE tiene su GHSA
```

---

## ğŸ“‹ CWEs Comunes

### Top 10 CWEs en Software

| CWE ID | Nombre | DescripciÃ³n |
|--------|--------|-------------|
| CWE-79 | XSS | Cross-site Scripting |
| CWE-89 | SQLi | SQL Injection |
| CWE-22 | Path Traversal | Directory traversal |
| CWE-78 | OS Command Injection | Command injection |
| CWE-94 | Code Injection | Arbitrary code execution |
| CWE-287 | Auth Issues | Authentication bypass |
| CWE-200 | Info Exposure | Information disclosure |
| CWE-352 | CSRF | Cross-Site Request Forgery |
| CWE-434 | File Upload | Unrestricted file upload |
| CWE-502 | Deserialization | Insecure deserialization |

### Buscar CWE Apropiado

```
https://cwe.mitre.org/

BÃºsqueda por:
- Keyword
- CWE ID
- Vulnerability type
```

---

## ğŸŒ Bases de Datos de Vulnerabilidades

### NVD (National Vulnerability Database)

```
https://nvd.nist.gov/

Contenido:
- Todos los CVEs publicados
- CVSS scores
- Referencias
- CPE (Common Platform Enumeration)
```

### GitHub Advisory Database

```
https://github.com/advisories

Contenido:
- GHSAs publicados en GitHub
- CVEs importados de NVD
- Advisories de ecosistemas (npm, PyPI, etc.)
- Curado por GitHub Security Lab
```

### Otras Fuentes

| Base de Datos | URL | Especialidad |
|---------------|-----|--------------|
| Snyk Vuln DB | snyk.io/vuln | MÃºltiples ecosistemas |
| npm Security | npmjs.com/advisories | npm packages |
| RubySec | rubysec.com | Ruby gems |
| Python Advisory | pypi.org/security | PyPI packages |

---

## ğŸ” Investigar un CVE

### InformaciÃ³n Disponible

```yaml
# Ejemplo: CVE-2021-44228 (Log4Shell)

CVE ID: CVE-2021-44228
Published: 2021-12-10
CVSS: 10.0 (Critical)
CWE: CWE-502 (Deserialization)

Affected:
  - Product: Apache Log4j
  - Versions: 2.0-beta9 to 2.14.1

Description: |
  Apache Log4j2 2.0-beta9 through 2.14.1 JNDI features do not
  protect against attacker controlled LDAP and other JNDI related
  endpoints.

References:
  - https://logging.apache.org/log4j/2.x/security.html
  - https://nvd.nist.gov/vuln/detail/CVE-2021-44228
```

### Buscar CVEs

```bash
# NVD Search
https://nvd.nist.gov/vuln/search?query=log4j

# GitHub Advisory Search
https://github.com/advisories?query=log4j

# Snyk
https://snyk.io/vuln/search?q=log4j
```

---

## ğŸ“ Ejercicio: Calcular CVSS

### Escenario

Una API permite a usuarios autenticados acceder a archivos del servidor usando el parÃ¡metro `?file=report.pdf`. Un atacante descubre que puede usar `?file=../../../etc/passwd` para leer archivos del sistema.

### Calcula el CVSS

```yaml
# Completa los valores:

Attack Vector: ___  # Â¿CÃ³mo se accede? (Network/Local/etc)
Attack Complexity: ___  # Â¿Es fÃ¡cil explotar?
Privileges Required: ___  # Â¿Necesita login?
User Interaction: ___  # Â¿Usuario debe hacer algo?
Scope: ___  # Â¿Afecta otros sistemas?
Confidentiality: ___  # Â¿Accede a datos?
Integrity: ___  # Â¿Puede modificar?
Availability: ___  # Â¿Afecta disponibilidad?
```

### Respuesta

```yaml
Attack Vector: Network (N)
Attack Complexity: Low (L)
Privileges Required: Low (L)  # Requiere autenticaciÃ³n
User Interaction: None (N)
Scope: Unchanged (U)
Confidentiality: High (H)  # Lee archivos del sistema
Integrity: None (N)
Availability: None (N)

Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
Score: 6.5 (Medium)
CWE: CWE-22 (Path Traversal)
```

---

## ğŸ¯ Resumen

| Concepto | DescripciÃ³n |
|----------|-------------|
| **CVE** | ID Ãºnico para vulnerabilidad |
| **CNA** | Autoridad que asigna CVEs |
| **CVSS** | Score de severidad (0-10) |
| **CWE** | CategorÃ­a de debilidad |
| **GHSA** | ID de advisory en GitHub |

---

## ğŸ“š Recursos Adicionales

- [CVSS v3.1 Calculator](https://www.first.org/cvss/calculator/3.1)
- [CWE Database](https://cwe.mitre.org/)
- [NVD](https://nvd.nist.gov/)
- [GitHub as CNA](https://docs.github.com/en/code-security/security-advisories/global-security-advisories/about-the-github-advisory-database)

---

## âœ… Checklist de ComprensiÃ³n

- [ ] Entiendo quÃ© es CVE y CNA
- [ ] Puedo calcular CVSS score bÃ¡sico
- [ ] SÃ© cÃ³mo solicitar CVE via GitHub
- [ ] Distingo entre CVE, GHSA y CWE

---

[â¬…ï¸ Anterior: Security Advisories](02-security-advisories.md) | [Siguiente: Incident Response â¡ï¸](04-incident-response.md)
