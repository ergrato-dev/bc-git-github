# üîç Ejercicio 01: Vulnerability Analysis

> **Duraci√≥n**: 40 minutos
>
> **Objetivo**: Analizar, clasificar y priorizar vulnerabilidades de seguridad.

---

## üéØ Objetivos de Aprendizaje

Al completar este ejercicio ser√°s capaz de:

- ‚úÖ Validar si un reporte de vulnerabilidad es leg√≠timo
- ‚úÖ Calcular **CVSS score** correctamente
- ‚úÖ Asignar **CWE** apropiado
- ‚úÖ Determinar **prioridad** (P1-P4)

---

## üìã Escenario

Eres parte del equipo de seguridad de una aplicaci√≥n web de e-commerce. Has recibido **4 reportes de vulnerabilidades** en las √∫ltimas 24 horas. Tu tarea es analizarlos, clasificarlos y priorizarlos.

---

## üî¨ Parte 1: An√°lisis de Reportes (20 min)

### Reporte A: SQL Injection en Login

```markdown
# Vulnerability Report

**Reporter**: external-researcher@email.com
**Date**: 2024-12-15

## Description
I found a SQL injection vulnerability in the login form.

## Steps to Reproduce
1. Go to /login
2. In username field, enter: admin'--
3. In password field, enter: anything
4. Click "Login"
5. You are logged in as admin without knowing the password

## Impact
Complete authentication bypass. Can access any user account.

## Proof of Concept
[Screenshot showing admin dashboard access]
```

#### Tarea A: Analiza este reporte

```yaml
# Completa tu an√°lisis:

1. ¬øEs v√°lida la vulnerabilidad?
   Respuesta: 

2. ¬øCu√°l es el CWE?
   Respuesta: CWE-___

3. Calcula el CVSS (completa cada m√©trica):
   Attack Vector (AV): ___  # N/A/L/P
   Attack Complexity (AC): ___  # L/H
   Privileges Required (PR): ___  # N/L/H
   User Interaction (UI): ___  # N/R
   Scope (S): ___  # U/C
   Confidentiality (C): ___  # N/L/H
   Integrity (I): ___  # N/L/H
   Availability (A): ___  # N/L/H
   
   CVSS Score: ___
   Severity: ___

4. ¬øQu√© prioridad asignas?
   Respuesta: P___

5. ¬øCu√°l es el SLA de respuesta?
   Respuesta: ___
```

---

### Reporte B: Reflected XSS en B√∫squeda

```markdown
# Vulnerability Report

**Reporter**: bugbounty-hunter@hackerone.com
**Date**: 2024-12-15

## Description
The search functionality reflects user input without sanitization.

## Steps to Reproduce
1. Go to /search
2. Search for: <script>alert('XSS')</script>
3. The script executes in the browser

## Impact
Can execute JavaScript in user's browser context.
Potential for session hijacking, phishing.

## Proof of Concept
[Video showing alert popup]
```

#### Tarea B: Analiza este reporte

```yaml
# Completa tu an√°lisis:

1. ¬øEs v√°lida la vulnerabilidad?
   Respuesta: 

2. ¬øCu√°l es el CWE?
   Respuesta: CWE-___

3. Calcula el CVSS:
   Attack Vector (AV): ___
   Attack Complexity (AC): ___
   Privileges Required (PR): ___
   User Interaction (UI): ___
   Scope (S): ___
   Confidentiality (C): ___
   Integrity (I): ___
   Availability (A): ___
   
   CVSS Score: ___
   Severity: ___

4. ¬øQu√© prioridad asignas?
   Respuesta: P___
```

---

### Reporte C: Informaci√≥n Sensible en Logs

```markdown
# Vulnerability Report

**Reporter**: internal-dev@company.com
**Date**: 2024-12-15

## Description
Our application logs contain user passwords in plain text.

## Location
/var/log/app/application.log

## Evidence
```
2024-12-15 10:30:45 INFO User login attempt: user=john@email.com password=MySecretPass123
2024-12-15 10:30:46 INFO Login successful for user john@email.com
```

## Impact
Anyone with log access can see user passwords.
Logs are rotated to S3 bucket with broad team access.
```

#### Tarea C: Analiza este reporte

```yaml
# Completa tu an√°lisis:

1. ¬øEs v√°lida la vulnerabilidad?
   Respuesta: 

2. ¬øCu√°l es el CWE?
   Respuesta: CWE-___  # Hint: Information Exposure

3. Calcula el CVSS:
   Attack Vector (AV): ___  # ¬øRequiere acceso local o red?
   Attack Complexity (AC): ___
   Privileges Required (PR): ___  # ¬øNecesita ser empleado?
   User Interaction (UI): ___
   Scope (S): ___
   Confidentiality (C): ___
   Integrity (I): ___
   Availability (A): ___
   
   CVSS Score: ___
   Severity: ___

4. ¬øQu√© prioridad asignas?
   Respuesta: P___
```

---

### Reporte D: Falso Positivo

```markdown
# Vulnerability Report

**Reporter**: automated-scanner@vendor.com
**Date**: 2024-12-15

## Description
Missing X-Content-Type-Options header on /api/health endpoint.

## Details
The endpoint does not set the X-Content-Type-Options: nosniff header.

## Impact
Potential MIME-type sniffing vulnerability.
```

#### Tarea D: Analiza este reporte

```yaml
# Completa tu an√°lisis:

1. ¬øEs v√°lida la vulnerabilidad?
   Respuesta: 

2. Justifica tu decisi√≥n:
   # ¬øPor qu√© es o no es un issue real?
   Respuesta: 

3. Si es v√°lida, ¬øqu√© CVSS?
   Respuesta: 

4. ¬øQu√© acci√≥n tomas?
   ‚ñ° Cerrar como "won't fix"
   ‚ñ° Cerrar como "informative"
   ‚ñ° Aceptar y priorizar
   ‚ñ° Solicitar m√°s informaci√≥n
```

---

## üìä Parte 2: Matriz de Priorizaci√≥n (10 min)

### Tarea: Crear la Matriz

Bas√°ndote en tu an√°lisis, completa esta matriz:

| Reporte | CWE | CVSS | Severity | Prioridad | SLA |
|---------|-----|------|----------|-----------|-----|
| A - SQL Injection | | | | | |
| B - Reflected XSS | | | | | |
| C - Logs con passwords | | | | | |
| D - Missing header | | | | | |

### Orden de Atenci√≥n

¬øEn qu√© orden atender√≠as estas vulnerabilidades?

```
1. _______________
2. _______________
3. _______________
4. _______________
```

---

## üîß Parte 3: Respuestas a Reporters (10 min)

### Tarea: Redacta Acknowledgements

Escribe la respuesta inicial (acknowledge) para cada reporter:

#### Respuesta a Reporte A (SQL Injection)

```markdown
Subject: Re: SQL Injection vulnerability report

Hi [Reporter],

Thank you for your security report regarding [COMPLETAR].

[COMPLETAR el mensaje]

Best regards,
Security Team
```

#### Respuesta a Reporte D (False Positive)

```markdown
Subject: Re: Missing X-Content-Type-Options header

Hi,

Thank you for your report. After reviewing [COMPLETAR].

[COMPLETAR el mensaje]

Best regards,
Security Team
```

---

## ‚úÖ Checklist de Completado

- [ ] Analic√© los 4 reportes
- [ ] Calcul√© CVSS para cada vulnerabilidad v√°lida
- [ ] Asign√© CWE correcto
- [ ] Determin√© prioridad basada en severidad + explotabilidad
- [ ] Cre√© matriz de priorizaci√≥n
- [ ] Redact√© acknowledgements apropiados

---

## üìù Soluci√≥n

<details>
<summary>Ver soluci√≥n (solo despu√©s de intentar)</summary>

### Reporte A: SQL Injection

```yaml
1. ¬øEs v√°lida? S√ç - Authentication bypass es cr√≠tico

2. CWE: CWE-89 (SQL Injection)

3. CVSS:
   AV: N (Network - accesible via web)
   AC: L (Low - f√°cil de explotar)
   PR: N (None - no requiere autenticaci√≥n)
   UI: N (None - no requiere interacci√≥n)
   S: U (Unchanged)
   C: H (High - acceso a todos los datos)
   I: H (High - puede modificar datos)
   A: N (None - no afecta disponibilidad)
   
   Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
   Score: 9.1 (Critical)

4. Prioridad: P1

5. SLA: Fix en 24-48 horas
```

### Reporte B: Reflected XSS

```yaml
1. ¬øEs v√°lida? S√ç - XSS permite robo de sesiones

2. CWE: CWE-79 (Cross-site Scripting)

3. CVSS:
   AV: N (Network)
   AC: L (Low)
   PR: N (None)
   UI: R (Required - usuario debe hacer click)
   S: C (Changed - afecta navegador del usuario)
   C: L (Low - acceso a sesi√≥n)
   I: L (Low - puede modificar p√°gina)
   A: N (None)
   
   Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
   Score: 6.1 (Medium)

4. Prioridad: P3
```

### Reporte C: Passwords en Logs

```yaml
1. ¬øEs v√°lida? S√ç - Exposici√≥n de credenciales

2. CWE: CWE-532 (Insertion of Sensitive Information into Log File)

3. CVSS:
   AV: L (Local - requiere acceso a logs)
   AC: L (Low)
   PR: L (Low - empleado con acceso a logs)
   UI: N (None)
   S: U (Unchanged)
   C: H (High - passwords expuestos)
   I: N (None)
   A: N (None)
   
   Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
   Score: 5.5 (Medium)

4. Prioridad: P2 (datos sensibles expuestos internamente)
```

### Reporte D: Missing Header

```yaml
1. ¬øEs v√°lida? NO/MARGINAL

2. Justificaci√≥n:
   - /api/health es endpoint de health check
   - Retorna JSON, no contenido ejecutable
   - El header es best practice pero no vulnerabilidad real
   - Impacto pr√°ctico: ninguno

3. CVSS: 0.0 o N/A (informational)

4. Acci√≥n: Cerrar como "informative"
   - Agradecer el reporte
   - Explicar por qu√© no es issue
   - Considerar agregar header como hardening
```

### Matriz Final

| Reporte | CWE | CVSS | Severity | Prioridad | SLA |
|---------|-----|------|----------|-----------|-----|
| A - SQL Injection | CWE-89 | 9.1 | Critical | P1 | 24-48h |
| B - Reflected XSS | CWE-79 | 6.1 | Medium | P3 | 30 d√≠as |
| C - Logs passwords | CWE-532 | 5.5 | Medium | P2 | 7 d√≠as |
| D - Missing header | N/A | 0.0 | Info | N/A | N/A |

### Orden de Atenci√≥n

```
1. A - SQL Injection (P1, Critical, 9.1)
2. C - Logs passwords (P2, data exposure)
3. B - XSS (P3, Medium)
4. D - Close as informative
```

</details>

---

## üìö Recursos

- [CVSS Calculator](https://www.first.org/cvss/calculator/3.1)
- [CWE Database](https://cwe.mitre.org/)
- [OWASP Top 10](https://owasp.org/Top10/)

---

[‚¨ÖÔ∏è Volver a Pr√°cticas](../README.md) | [Siguiente: Security Advisory ‚û°Ô∏è](../ejercicio-02-security-advisory/)
